# Copyright 2012 Nikolay Orlyuk
# Distributed under the terms of the GNU General Public License v2

require github \
        autotools [ supported_automake=[ 1.12 ] supported_autoconf=[ 2.5 ] ]

SUMMARY="The F# compiler, core library and core tools (open source edition)"

LICENCES="Apache-2.0"
SLOT="0"
PLATFORMS="~amd64"
MYOPTIONS=""

DEPENDENCIES="
    build:
        net-misc/curl
        virtual/pkg-config
    build+run:
        dev-lang/mono[>=4.2.2.30-r1]
"

BUGS_TO="virkony@gmail.com"

DEFAULT_SRC_CONFIGURE_PARAMS=( --with-gacdir="/usr/$(exhost --target)/lib/mono/gac" )

DEFAULT_SRC_COMPILE_PARAMS=( -j1 )

src_compile() {
    # uses NuGet to build, no easy way around,
    # unless you like the alternative in e.g. games-strategy/openra
    esandbox disable_net
    default
    esandbox enable_net
}

src_install() {
    esandbox disable_net
    default
    esandbox enable_net

    # delete empty directories
    edo find "${IMAGE}" -type d -empty -delete
}

